"use strict";(function(n){var t={find:"input, textarea, select",not:":submit, :reset, :image, :disabled, :hidden",unsafe:["<",">"],msg:{unsafe:"字段含有非法字符！",email:"请输入正确的Email格式！"}},r=function(n){if(n.length>0)for(var i in t.unsafe)if(n.indexOf(t.unsafe[i])>-1)return!0;return!1},i=function(i){var u=!0;return n(i).find(t.find).not(t.not).each(function(){var s="text",f,o,i,e,h,c,l,a,v,y,p,w;if(n(this).attr("type")!=undefined&&(s=n(this).attr("type").toLowerCase()),f=n(this).val(),o="",n(this).attr("xy-title")!=undefined&&(o=n.trim(n(this).attr("xy-title"))),i="",n(this).attr("xy-rel-id")!=undefined&&(i=n.trim(n(this).attr("xy-rel-id"))),e="",n(this).attr("xy-rel-reg")!=undefined&&(e=n.trim(n(this).attr("xy-rel-reg"))),(n(this).attr("xy-unsafe")==undefined||n(this).attr("xy-unsafe").toLowerCase()!="true")&&r(f))return alert(t.msg.unsafe),this.focus(),u=!1,!1;if(n(this).attr("xy-required")!=undefined&&n(this).attr("xy-required").toLowerCase()=="true"&&n.trim(f).length==0&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))||n(this).attr("xy-not")!=undefined&&n(this).attr("xy-not")==f&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))||n(this).attr("xy-pattern")!=undefined&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))&&(h=n(this).attr("xy-pattern"),h.length>0&&new RegExp(h).test(f)==!1))return o.length>0&&alert(o),this.focus(),u=!1,!1;if(n(this).attr("xy-func")!=undefined&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))&&(c=n(this).attr("xy-func"),c.length>0&&eval(c)==!1))return u=!1,!1;if(n(this).attr("xy-same")!=undefined&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))&&(l=n(this).attr("xy-same"),l.length>0&&n(this).val()!=n("#"+l).val()))return o.length>0&&alert(o),this.focus(),u=!1,!1;if(s=="number"&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))){if(a=parseFloat(f),n(this).attr("xy-min")!=undefined&&(v=parseFloat(n(this).attr("xy-min")),a<v))return alert("字段值不能小于"+v+"！"),this.focus(),u=!1,!1;if(n(this).attr("xy-max")!=undefined&&(y=parseFloat(n(this).attr("xy-max")),a>y))return alert("字段值不能大于"+y+"！"),this.focus(),u=!1,!1;if(p=n(this).attr("xy-geq-id"),p!=undefined&&(w=parseFloat(n.trim(n("#"+p).val())),parseFloat(f)<w))return alert("字段值不能小于"+w+"！"),this.focus(),u=!1,!1}if(s=="email"&&f.length>0&&(i.length==0||n("#"+i).length>0&&new RegExp(e).test(n.trim(n("#"+i).val())))&&(f.length<=4||/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(f)==!1))return alert(t.msg.email),this.focus(),u=!1,!1}),u};n.fn.extend({xyvInit:function(r){if(this.length){var u=n(this).find(t.find).not(t.not);if(u.length>0&&u.each(function(){var f="text",i,t,r,u;n(this).attr("type")!=undefined&&(f=n(this).attr("type").toLowerCase());i=n(this).val();f=="number"&&(t=n(this).attr("step"),t!=undefined&&(t=n.trim(t),isNaN(t)||(r=0,u=t.indexOf("."),u>-1&&(r=t.length-u-1),r<=0?(n(this).keypress(function(n){var t=n.charCode?n.charCode:n.keyCode;(t<48||t>57)&&t!=8&&t!=45&&n.preventDefault()}),n(this).blur(function(){var t=n.trim(n(this).val());(t.length==0||/^-?\d+$/.test(t)==!1)&&(i.length>0?n(this).val(i):n(this).val(0))})):(n(this).keypress(function(n){var t=n.charCode?n.charCode:n.keyCode;(t<48||t>57)&&t!=8&&t!=45&&t!=46&&n.preventDefault()}),n(this).blur(function(){var t=n.trim(n(this).val());t.length==0||isNaN(t)?i.length>0?n(this).val(i):n(this).val(0):n(this).val(parseFloat(t).toFixed(r))})))))}),r)n(this).on("submit",function(){return i(this)})}},xyvValid:function(){return this.length?i(this):!1}})})(jQuery);