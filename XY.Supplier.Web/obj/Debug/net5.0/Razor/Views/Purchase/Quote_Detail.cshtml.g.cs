#pragma checksum "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "37a60a6eaf8f9c421135eb3dbb6cfc817d77c1a3"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Purchase_Quote_Detail), @"mvc.1.0.view", @"/Views/Purchase/Quote_Detail.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
using System.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
using XY.Supplier.Web;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"37a60a6eaf8f9c421135eb3dbb6cfc817d77c1a3", @"/Views/Purchase/Quote_Detail.cshtml")]
    public class Views_Purchase_Quote_Detail : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<XY.Supplier.Web.Models.Purchase.Quote_Detail_Model>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\r\n");
#nullable restore
#line 5 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
  
    Layout = "~/Views/Shared/Normal.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<script type=""text/javascript"">
    //<![CDATA[

    require(['jquery', 'xy', 'xyvalid', 'boss', 'laydate'], function ($, xy, v, boss, laydate) {
        $(function () {
            boss.tableInit($('#tableOrderItem'));
            //初始化日期样式
            laydate.render({
                elem: '#Promise',
                theme: boss.configPrimaryColor,
                type: 'datetime'
            });
            var _form = $('form:first');
            _form.xyvInit();

            var idArray = new Array();
            var price_array = new Array();
            //点击返回
            $('#Cancel').on('click', function () {
                boss.load('");
#nullable restore
#line 28 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                      Write(Html.Raw(Model.BackUrl));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"');
            });
            //提交报价
            $('#Submit').on('click', function () {
                var time = $(""#Promise"").val();
                if (time.length == 0) {
                    alert('请选择送达时间');
                    return false;
                }
                price_array = [];
                idArray = [];
                var tab = document.getElementById('tableOrderItem');
                var rows = tab.rows;
                for (var i = 1; i < rows.length; i++) {
                    for (var j = 0; j < rows[i].cells.length; j++) {
                        if (j == 0) {
                            var check = rows[i].getElementsByTagName('input')[0];
                            idArray.push(check.value);
                            var num = rows[i].getElementsByTagName('input')[1];
                            if (num.value.length = 0 || num.value.match(/^[ ]*$/)) {
                                price_array.push(0);
                            }
                ");
            WriteLiteral(@"            else {
                                price_array.push(num.value);
                            }
                        }
                    }
                }
                if (price_array.length == idArray.length) {
                    var supplier_id = ");
#nullable restore
#line 57 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                 Write(Model.Supplier_Id);

#line default
#line hidden
#nullable disable
            WriteLiteral(";\r\n                    var pi_id = ");
#nullable restore
#line 58 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                           Write(Model.Inquiry_Id);

#line default
#line hidden
#nullable disable
            WriteLiteral(@";
                    var all_data = {
                        Deliver_time: JSON.stringify($(""#Promise"").val()),
                        SupplierId: JSON.stringify(supplier_id),
                        InquiryId: JSON.stringify(pi_id),
                        InquiryItemIds: JSON.stringify(idArray),
                        PriceNums: JSON.stringify(price_array)
                    }
                    $.ajax({
                    type: ""post"",
                    url: ""/purchase/Quote_Insert"",
                    data: all_data,
                    dataType: ""json"",
                    beforeSend: function () {
                        $(""#Submit"").attr(""disable"", true);
                    },
                    success: function (res) {
                        if (res > 0) {
                            alert(""创建成功！"");
                            boss.load('");
#nullable restore
#line 77 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                  Write(Html.Raw("/purchase/quote"));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"');
                        } else {
                            alert(""参数解析失败！"")
                        }
                    }
                })
                } else {
                    alert(""参数错误！"");
                    return false;
                }
            });
        });
    });

    //]]>
</script>

");
#nullable restore
#line 94 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
 using (Html.BeginForm())
{



#line default
#line hidden
#nullable disable
            WriteLiteral("    <div class=\"container-fluid\">\r\n        <div class=\"fl w100p\">\r\n");
#nullable restore
#line 100 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
             if (!Model.IsQuote)
            {

#line default
#line hidden
#nullable disable
            WriteLiteral("                <button id=\"Submit\" type=\"button\" class=\"btn btn-sm btn-warning mb10 fr \">\r\n                    <i class=\"fas fa-save\" aria-hidden=\"true\"></i>\r\n                    <span>提交报价</span>\r\n                </button>\r\n");
#nullable restore
#line 106 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
            }

#line default
#line hidden
#nullable disable
            WriteLiteral(@"            <button id=""Cancel"" type=""button"" class=""btn btn-sm btn-warning mb10 fr mr10"">
                <i class=""fas fa-arrow-left"" aria-hidden=""true""></i>
                <span>返回</span>
            </button>
        </div>
        <div class=""card"">
            <div class=""card-header b"">询价单详情</div>
            <div class=""card-body"">
                <div class=""row justify-content-center mt1r mb05r"">
                    <div class=""col-xl-1 gray"">询价订单号</div>
                    <div class=""col-xl-4"">");
#nullable restore
#line 117 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                      Write(Model.Order_No);

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                    <div class=\"col-xl-1 gray\">发起人</div>\r\n                    <div class=\"col-xl-4\">\r\n                        ");
#nullable restore
#line 120 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                    Write(Model.Creator_Name);

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n                    </div>\r\n                </div>\r\n                <div class=\"row justify-content-center mb05r\">\r\n                    <div class=\"col-xl-1 gray\">发布时间</div>\r\n                    <div class=\"col-xl-4\">");
#nullable restore
#line 125 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                      Write(Model.Create_time.ToString("yyyy.MM.dd HH:mm:ss"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                    <div class=\"col-xl-1 gray\">报价截止时间</div>\r\n                    <div class=\"col-xl-4\">");
#nullable restore
#line 127 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                      Write(Model.End_time.ToString("yyyy.MM.dd HH:mm:ss"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                </div>\r\n                <div class=\"row justify-content-center mb05r\">\r\n                    <div class=\"col-xl-1 gray\">状态</div>\r\n                    <div class=\"col-xl-4\">");
#nullable restore
#line 131 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                      Write(Model.Status);

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                    <div class=\"col-xl-1 gray\">要求交货时间</div>\r\n                    <div class=\"col-xl-4\">");
#nullable restore
#line 133 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                     Write(Model.Deliver_time.ToString("yyyy.MM.dd HH:mm:ss"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                </div>\r\n                <div class=\"row justify-content-center mb05r\">\r\n                    <div class=\"col-xl-1 gray\">备注</div>\r\n                    <div class=\"col-xl-4 oneLine\"");
            BeginWriteAttribute("title", " title=\"", 5576, "\"", 5599, 1);
#nullable restore
#line 137 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
WriteAttributeValue("", 5584, Model.Remark, 5584, 15, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(">");
#nullable restore
#line 137 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                                                      Write(Model.Remark);

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                    <div class=\"col-xl-1 gray\"><span class=\"fl red b pt0125r\">*</span>承诺送达时间</div>\r\n");
#nullable restore
#line 139 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                     if (Model.IsQuote)
                    {

#line default
#line hidden
#nullable disable
            WriteLiteral("                        <div class=\"col-xl-4\"> ");
#nullable restore
#line 141 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                          Write(Model.Promise_Deliver_time.Value.ToString("yyyy.MM.dd hh:mm:ss"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n");
#nullable restore
#line 142 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                    }
                    else
                    {

#line default
#line hidden
#nullable disable
            WriteLiteral("                        <div class=\"col-xl-4\">\r\n                            <input id=\"Promise\"");
            BeginWriteAttribute("value", " value=\"", 6075, "\"", 6083, 0);
            EndWriteAttribute();
            WriteLiteral(" type=\"text\" maxlength=\"19\" autocomplete=\"off\" class=\"form-control cp \" style=\"width:40%;padding-left:2px;\" />\r\n                        </div>\r\n");
#nullable restore
#line 148 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                    }

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
                </div>
            </div>
            <div class=""card"" style=""background-color: rgba(236,240,245); border: none;"">
                <div class=""boss_table_top mt10 ml15"">
                    <div class=""fl mb10 subtitle"" style=""font-size: .85rem;"">询价单包含物料</div>
                </div>
                <div class=""boss_table_body table-responsive"">
                    <table id=""tableOrderItem"" class=""table table-bordered table-hover"" style=""width: 30rem;"">
                        <thead>
                            <tr>
                                <th class=""w1p"" style=""display:none;""><input id=""SelectAll"" type=""checkbox"" /></th>
                                <th class=""w3p"">#</th>
");
            WriteLiteral("                                <th class=\"w10p\">物料编码</th>\r\n                                <th class=\"w10p\">物料分类</th>\r\n                                <th class=\"w10p\">数量（PCS）</th>\r\n");
            WriteLiteral("                                <th class=\"w20p\">本次报价（RMB）</th>\r\n                                <th class=\"w20p text-right\">图纸</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n");
#nullable restore
#line 172 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                             if (Model.Item_List != null && Model.Item_List.Count() > 0)
                            {
                                var ii = 0;
                                var pages = Convert.ToInt32(XY.Http.QueryString(Context.Request, "page", "1"));
                                var pagesize = Convert.ToInt32(XY.Http.QueryString(Context.Request, "pagesize", "30"));
                                foreach (DataRow dr in Model.Item_List)
                                {
                                    ii++;
                                    string fileIds = dr["fileIds"].ToString();
                                    string fileNames = dr["fileNames"].ToString();
                                    string[] fileIdArr = fileIds.Split(",");
                                    string[] fileNameArr = fileNames.Split(",");
                                    string pdfHtml = "";

                                    if (!string.IsNullOrEmpty(fileIds))
                                    {
                                        for (int i = 0; i < fileIdArr.Length; i++)
                                        {
                                            string fileId = fileIdArr[i];
                                            string fileName = fileNameArr[i];
                                            if (!string.IsNullOrEmpty(pdfHtml))
                                            {
                                                pdfHtml += "<br />";
                                            }
                                            string fileUrl = XY.Business.Tools.FileUrl(XY.Boss.Configs.FileSiteURL, int.Parse(fileId), "pdf");
                                            pdfHtml += "<a href='" + fileUrl + "' target='_blank'>" + fileName + "</a>";

                                        }

                                    }


#line default
#line hidden
#nullable disable
            WriteLiteral("                            <tr>\r\n                                <td style=\"display:none;\"><input type=\"checkbox\"");
            BeginWriteAttribute("value", " value=\"", 9569, "\"", 9603, 1);
#nullable restore
#line 204 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
WriteAttributeValue("", 9577, dr["pii_id"].ToString(), 9577, 26, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" /></td>\r\n                                <td>");
#nullable restore
#line 205 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                Write(((pages - 1) * pagesize + ii).ToString());

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n");
            WriteLiteral("                                <td>");
#nullable restore
#line 207 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                               Write(dr["code"]);

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                                <td>");
#nullable restore
#line 208 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                               Write(dr["cate_name"]);

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                                <td align=\"right\">");
#nullable restore
#line 209 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                              Write(((decimal)dr["item_qty"]).ToString("#0.00"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n");
#nullable restore
#line 211 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                 if (Model.IsQuote)
                                {

#line default
#line hidden
#nullable disable
            WriteLiteral("                                    <td align=\"right\">\r\n                                        ");
#nullable restore
#line 214 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                    Write((dr["price"] == System.DBNull.Value || (decimal)dr["price"] == 0) ? "未报价" : ((decimal)dr["price"]).ToString("#0.00"));

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n                                    </td>\r\n");
#nullable restore
#line 216 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"

                                }
                                else
                                {

#line default
#line hidden
#nullable disable
            WriteLiteral(@"                                    <td>
                                        <input type=""text"" style=""width: 100%;border: none; text-align: right;"" value="" "" autocomplete=""off""
                                               onchange=""this.setAttribute('value',$.trim(this.value));""
                                               onkeyup=""value=value.replace(/[^1-9]{0,1}(\d*(?:\.\d{0,6})?).*$/g, '$1')"" />
                                    </td>
");
#nullable restore
#line 225 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                }

#line default
#line hidden
#nullable disable
            WriteLiteral("                                <td>");
#nullable restore
#line 226 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                               Write(Html.Raw(pdfHtml));

#line default
#line hidden
#nullable disable
            WriteLiteral("</td>\r\n                            </tr>\r\n");
#nullable restore
#line 228 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
                                }
                            }

#line default
#line hidden
#nullable disable
            WriteLiteral("                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        ");
#nullable restore
#line 235 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
   Write(Html.Pager(XY.Http.RequestUrl(Context.Request), Model.Item_List));

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n    </div>\r\n");
#nullable restore
#line 237 "D:\GIT.NEWARE.WORK\neware-mes\Sources\XY.Supplier.Web\Views\Purchase\Quote_Detail.cshtml"
}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<XY.Supplier.Web.Models.Purchase.Quote_Detail_Model> Html { get; private set; }
    }
}
#pragma warning restore 1591
